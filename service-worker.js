var cacheName="v2",cacheFiles=["./","./index.html","./main.min.js","./manifest.json","https://fonts.googleapis.com/css?family=Roboto:300,400,500"];self.addEventListener("install",function(e){console.log("[SERVICEWORKER] Installed!"),e.waitUntil(caches.open(cacheName).then(function(e){return console.log("[SERVICEWORKER] caching cache files"),e.addAll(cacheFiles)}))}),self.addEventListener("activate",function(e){console.log("[SERVICEWORKER] Installed!"),e.waitUntil(caches.keys().then(function(e){return Promise.all(e.map(function(e){return e!=cacheName?(console.log("[SERVICEWORKER] removing cached files from "+e),caches.delete(e)):void 0}))}))}),self.addEventListener("periodicSync",function(e){"get-latest-announcement"==e.registration.tag?e.waitUntil(function(){var e=new XMLHttpRequest;e.withCredentials=!0,e.addEventListener("readystatechange",function(){if(4===this.readyState){var e=JSON.parse(this.responseText).length,n=JSON.parse(localStorage.getItem("announcements")).length;if(e>n){console.log("[SERVICEWORKER] [BACKGROUNDSYNC] New announcements !!!");var t={body:"You have "+(e-n)+" new announcements!"},o=new Notification("New notification from Anunciar",t);o.onshow=function(){console.log("Notification was shown")}}else console.warn("[SERVICEWORKER] [BACKGROUNDSYNC] No new announcements!!!");console.log(this.responseText)}}),e.open("GET","http://anunciar-backend.herokuapp.com/v1/announcements"),e.setRequestHeader("authorization",JSON.parse(localStorage.getItem("user")).access_token),e.send()}):e.registration.unregister()}),self.addEventListener("fetch",function(e){console.log("[SERVICEWORKER] fetching!",e.request.url);const n=(e.request,new URL(e.request.url));return n.origin!==location.origin?void console.warn("[SERVICEWORKER] not caching because not from origin"):void e.respondWith(caches.match(e.request).then(function(n){if(n)return console.log("[SERVICEWORKER] found in cache",e.request.url),n;var t=e.request.clone();return fetch(t).then(function(n){if(!n)return console.log("[SERVICEWORKER] no response from fetch"),n;var t=n.clone();caches.open(cacheName).then(function(o){return o.put(e.request,t),n})}).catch(function(e){console.log("[SERVICEWORKER] error in fetching and caching",e)})}))});